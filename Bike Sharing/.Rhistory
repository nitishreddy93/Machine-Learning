# Another example
# y is the consumption expenditure
# x2 is the income
# x3 is the wealth
y <- c(70, 65, 90, 95, 110, 115, 120, 140, 155, 150)
x2 <- c(80,100,120,140,160,180,200,220,240,260)
x3 <- c(810, 1009, 1273, 1425, 1633, 1876, 2052, 2201, 2435, 2686)
cons <- data.frame(y,x2,x3)
my.lm1 <- lm(y~x2+x3, data=cons)
summary(my.lm1)
vif(my.lm1)
# Detection and Handling of Multicollinearity
library(faraway)
vif(my.lm1)
setwd("~/Projects/Bike Sharing")
head(data)
data = read.csv("R.csv")
head(data)
library(faraway)
holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4
lm(count~.,data=data)
mymodel <- lm(count~.,data=data)
summary(mymodel)
vif(mymodel)
mymodel <- lm(count~holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4,data=data)
summary(mymodel)
vif(mymodel)
library(lmtest)
bptest(mymodel)
ols_test_breusch_pagan(lmtest, rhs = TRUE, multiple = TRUE, p.adj = 'bonferroni')
install.packages("caret")
library(caret)
bptest(mymodel)
distBCMod <- caret::BoxCoxTrans(data$count)
print(distBCMod)
head(data)
data <- cbind(data, dist_new=predict(distBCMod, data$count))
head(data)
mymodel <- lm(dist_new~holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4,data=data)
summary(mymodel)
data = read.csv("R.csv")
head(data)
library(faraway)
mymodel <- lm(count~.,data=data)
summary(mymodel)
data = read.csv("R.csv")
head(data)
library(faraway)
mymodel <- lm(count~holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4,data=data)
mymodel <- lm(count~.,data=data)
summary(mymodel)
vif(mymodel)
mymodel <- lm(count~holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4,data=data)
#mymodel <- lm(count~.,data=data)
summary(mymodel)
vif(mymodel)
library(lmtest)
library(caret)
bptest(mymodel)
distBCMod <- caret::BoxCoxTrans(data$count)
print(distBCMod)
data <- cbind(data, dist_new=predict(distBCMod, data$count))
head(data)
mymodel <- lm(dist_new~holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4,data=data)
summary(mymodel)
vif(mymodel)
bptest(mymodel)
data = read.csv("R.csv")
head(data)
library(faraway)
mymodel <- lm(count~holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4,data=data)
#mymodel <- lm(count~.,data=data)
summary(mymodel)
vif(mymodel)
library(lmtest)
library(caret)
bptest(mymodel)
distBCMod <- caret::BoxCoxTrans(data$count)
print(distBCMod)
data <- cbind(data, dist_new=predict(distBCMod, data$count))
head(data)
mymodel <- lm(dist_new~holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4,data=data)
summary(mymodel)
bptest(mymodel)
data = read.csv("R.csv")
head(data)
data = read.csv("R.csv")
head(data)
library(faraway)
mymodel <- lm(count~holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4,data=data)
#mymodel <- lm(count~.,data=data)
summary(mymodel)
vif(mymodel)
library(lmtest)
library(caret)
bptest(mymodel)
distBCMod <- caret::BoxCoxTrans(data$count)
print(distBCMod)
data <- cbind(data, count=predict(distBCMod, data$count))
head(data)
data = read.csv("R.csv")
head(data)
print(distBCMod)
data <- cbind(data, count=predict(distBCMod, data$count))
data = read.csv("R.csv")
head(data)
mymodel <- lm(count~holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4,data=data)
#mymodel <- lm(count~.,data=data)
summary(mymodel)
vif(mymodel)
library(lmtest)
library(caret)
bptest(mymodel)
distBCMod <- caret::BoxCoxTrans(data$count)
print(distBCMod)
data <- cbind(data, count=predict(distBCMod, data$count))
head(data)
data <- cbind(data, count_1=predict(distBCMod, data$count))
head(data)
data = read.csv("R.csv")
head(data)
library(faraway)
mymodel <- lm(count~holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4,data=data)
#mymodel <- lm(count~.,data=data)
summary(mymodel)
vif(mymodel)
library(lmtest)
library(caret)
bptest(mymodel)
distBCMod <- caret::BoxCoxTrans(data$count)
print(distBCMod)
data <- cbind(data, count_1=predict(distBCMod, data$count))
head(data)
mymodel <- lm(count_1~holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4,data=data)
summary(mymodel)
bptest(mymodel)
data = read.csv("R.csv")
head(data)
library(faraway)
mymodel <- lm(count~holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4,data=data)
mymodel <- lm(count~.,data=data)
summary(mymodel)
vif(mymodel)
library(lmtest)
library(caret)
bptest(mymodel)
distBCMod <- caret::BoxCoxTrans(data$count)
print(distBCMod)
data <- cbind(data, count_1=predict(distBCMod, data$count))
head(data)
mymodel <- lm(count_1~.,data=data)
summary(mymodel)
bptest(mymodel)
data = read.csv("R.csv")
head(data)
library(faraway)
mymodel <- lm(count~holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4,data=data)
mymodel <- lm(count~.,data=data)
summary(mymodel)
vif(mymodel)
library(lmtest)
library(caret)
bptest(mymodel)
distBCMod <- caret::BoxCoxTrans(data$count)
print(distBCMod)
data <- cbind(data, count_1=predict(distBCMod, data$count))
head(data)
mymodel <- lm(count_1~.,data=data)
summary(mymodel)
bptest(mymodel)
data = read.csv("R.csv")
head(data)
library(faraway)
data = read.csv("R.csv")
head(data)
library(faraway)
mymodel <- lm(count~holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4,data=data)
mymodel <- lm(count~.,data=data)
summary(mymodel)
vif(mymodel)
library(lmtest)
library(caret)
bptest(mymodel)
distBCMod <- caret::BoxCoxTrans(data$count)
print(distBCMod)
data <- cbind(data, count_1=predict(distBCMod, data$count))
head(data)
mymodel <- lm(count_1~.,data=data)
summary(mymodel)
data = read.csv("R.csv")
head(data)
library(faraway)
mymodel <- lm(count~holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4,data=data)
mymodel <- lm(count~.,data=data)
summary(mymodel)
vif(mymodel)
library(lmtest)
library(caret)
bptest(mymodel)
distBCMod <- caret::BoxCoxTrans(data$count)
print(distBCMod)
data <- cbind(data, count_1=predict(distBCMod, data$count))
head(data)
mymodel <- lm(count_1~.,data=data)
summary(mymodel)
data$count <- NULL
head(data)
mymodel <- lm(count_1~.,data=data)
summary(mymodel)
bptest(mymodel)
data = read.csv("R.csv")
head(data)
library(faraway)
mymodel <- lm(count~holiday+humidity+temp+windspeed+workingday+year+day+hour+season_2+season_3+season_4+weather_2+weather_3+weather_4,data=data)
mymodel <- lm(count~.,data=data)
summary(mymodel)
vif(mymodel)
library(lmtest)
library(caret)
bptest(mymodel)
distBCMod <- caret::BoxCoxTrans(data$count)
print(distBCMod)
data <- cbind(data, count_1=predict(distBCMod, data$count))
data$count <- NULL
head(data)
mymodel <- lm(count_1~.,data=data)
summary(mymodel)
data = read.csv("R.csv")
head(data)
library(faraway)
mymodel <- lm(count~.,data=data)
summary(mymodel)
vif(mymodel)
library(lmtest)
library(caret)
bptest(mymodel)
distBCMod <- caret::BoxCoxTrans(data$count)
print(distBCMod)
data <- cbind(data, count_1=predict(distBCMod, data$count))
data$count <- NULL
head(data)
mymodel <- lm(count_1~.,data=data)
summary(mymodel)
bptest(mymodel)
